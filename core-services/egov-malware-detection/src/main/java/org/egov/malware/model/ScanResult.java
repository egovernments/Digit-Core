package org.egov.malware.model;

import com.fasterxml.jackson.annotation.JsonProperty;
import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class ScanResult {

    @JsonProperty("id")
    private String id;

    @JsonProperty("fileStoreId")
    private String fileStoreId;

    @JsonProperty("tenantId")
    private String tenantId;

    @JsonProperty("fileName")
    private String fileName;

    @JsonProperty("filePath")
    private String filePath;

    @JsonProperty("fileHash")
    private String fileHash;

    @JsonProperty("fileSize")
    private Long fileSize;

    @JsonProperty("status")
    private ScanStatus status;

    @JsonProperty("virusName")
    private String virusName;

    @JsonProperty("scanEngine")
    private String scanEngine;

    @JsonProperty("scanEngineVersion")
    private String scanEngineVersion;

    @JsonProperty("scanDurationMs")
    private Long scanDurationMs;

    @JsonProperty("rawResponse")
    private String rawResponse;

    @JsonProperty("quarantined")
    private Boolean quarantined;

    @JsonProperty("quarantinePath")
    private String quarantinePath;

    @JsonProperty("notificationSent")
    private Boolean notificationSent;

    @JsonProperty("createdBy")
    private String createdBy;

    @JsonProperty("createdTime")
    private Long createdTime;

    @JsonProperty("lastModifiedBy")
    private String lastModifiedBy;

    @JsonProperty("lastModifiedTime")
    private Long lastModifiedTime;

    /**
     * Helper method to check if the scan result indicates an infected file.
     */
    public Boolean getInfected() {
        return status == ScanStatus.INFECTED;
    }
}
