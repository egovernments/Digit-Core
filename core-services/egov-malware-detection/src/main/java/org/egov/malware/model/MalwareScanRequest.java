package org.egov.malware.model;

import com.fasterxml.jackson.annotation.JsonProperty;
import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

/**
 * Malware scan request received from egov-filestore via Kafka.
 *
 * This model represents the scan request event published when a file is uploaded.
 * The malware detection service consumes these events and triggers ClamAV scanning.
 *
 * Topic: egov.malware.file-scan-request
 */
@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class MalwareScanRequest {

    /**
     * Unique identifier of the file in the filestore
     */
    @JsonProperty("fileStoreId")
    private String fileStoreId;

    /**
     * Tenant ID of the file owner
     */
    @JsonProperty("tenantId")
    private String tenantId;

    /**
     * Module that uploaded the file
     */
    @JsonProperty("module")
    private String module;

    /**
     * Original file name
     */
    @JsonProperty("fileName")
    private String fileName;

    /**
     * MIME type of the file
     */
    @JsonProperty("contentType")
    private String contentType;

    /**
     * Storage backend (minio, AzureBlobStorage, etc.)
     */
    @JsonProperty("fileSource")
    private String fileSource;

    /**
     * Full path of the file in storage
     */
    @JsonProperty("filePath")
    private String filePath;

    /**
     * UUID of the user who uploaded the file
     */
    @JsonProperty("uploadedBy")
    private String uploadedBy;

    /**
     * Timestamp when the file was uploaded (epoch millis)
     */
    @JsonProperty("uploadedTime")
    private Long uploadedTime;
}
