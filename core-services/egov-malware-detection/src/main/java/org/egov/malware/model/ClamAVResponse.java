package org.egov.malware.model;

import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class ClamAVResponse {

    private boolean clean;
    private ScanStatus status;
    private String virusName;
    private String rawResponse;
    private String errorMessage;
    private Long scanDurationMs;

    public static ClamAVResponse clean(String rawResponse, Long scanDurationMs) {
        return ClamAVResponse.builder()
                .clean(true)
                .status(ScanStatus.CLEAN)
                .rawResponse(rawResponse)
                .scanDurationMs(scanDurationMs)
                .build();
    }

    public static ClamAVResponse infected(String virusName, String rawResponse, Long scanDurationMs) {
        return ClamAVResponse.builder()
                .clean(false)
                .status(ScanStatus.INFECTED)
                .virusName(virusName)
                .rawResponse(rawResponse)
                .scanDurationMs(scanDurationMs)
                .build();
    }

    public static ClamAVResponse error(String errorMessage) {
        return ClamAVResponse.builder()
                .clean(false)
                .status(ScanStatus.ERROR)
                .errorMessage(errorMessage)
                .build();
    }
}
