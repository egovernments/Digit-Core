package org.egov.malware.validator;

import lombok.extern.slf4j.Slf4j;
import org.egov.malware.model.FileInfo;
import org.egov.tracer.model.CustomException;
import org.springframework.stereotype.Component;

@Component
@Slf4j
public class FileExistsValidator {

    public void validate(FileInfo fileInfo) {
        if (fileInfo == null) {
            throw new CustomException("FILE_NOT_FOUND", "File does not exist or could not be retrieved");
        }

        if (fileInfo.getContent() == null && fileInfo.getInputStream() == null) {
            log.error("File content is empty for fileStoreId: {}", fileInfo.getFileStoreId());
            throw new CustomException("FILE_CONTENT_EMPTY",
                    String.format("File content is empty for fileStoreId: %s", fileInfo.getFileStoreId()));
        }

        log.debug("File exists validation passed for fileStoreId: {}", fileInfo.getFileStoreId());
    }
}
