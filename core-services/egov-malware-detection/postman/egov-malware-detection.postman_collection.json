{
  "info": {
    "name": "egov-malware-detection",
    "description": "API collection for testing egov-malware-detection service.\n\nThis collection includes:\n- Health & Status endpoints\n- Test endpoints for development\n- Scan endpoints for production use\n\n**Note:** Test endpoints (/_test/*) should be disabled or secured in production.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8087",
      "type": "string"
    },
    {
      "key": "tenantId",
      "value": "pb",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Health & Status",
      "item": [
        {
          "name": "Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/malware-detection/health",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "health"]
            },
            "description": "Check service health and ClamAV connectivity"
          }
        },
        {
          "name": "Readiness Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/malware-detection/ready",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "ready"]
            },
            "description": "Check if service is ready to process requests"
          }
        },
        {
          "name": "Version Info",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/malware-detection/version",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "version"]
            },
            "description": "Get service and ClamAV version information"
          }
        }
      ]
    },
    {
      "name": "Test - ClamAV",
      "description": "Test ClamAV scanner functionality",
      "item": [
        {
          "name": "Ping ClamAV",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/malware-detection/v1/_test/clamav/ping",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "v1", "_test", "clamav", "ping"]
            },
            "description": "Test ClamAV daemon connectivity and get version info"
          }
        },
        {
          "name": "Scan EICAR Test String",
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/malware-detection/v1/_test/clamav/scan-eicar",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "v1", "_test", "clamav", "scan-eicar"]
            },
            "description": "Scan the standard EICAR test string. This SHOULD be detected as malware - it's a standard antivirus test pattern."
          }
        },
        {
          "name": "Scan Clean Content",
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/malware-detection/v1/_test/clamav/scan-clean",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "v1", "_test", "clamav", "scan-clean"]
            },
            "description": "Scan clean content. This should NOT be detected as malware."
          }
        },
        {
          "name": "Scan Custom Content",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"content\": \"Your custom content to scan goes here\",\n  \"fileName\": \"test-file.txt\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/malware-detection/v1/_test/clamav/scan-content",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "v1", "_test", "clamav", "scan-content"]
            },
            "description": "Scan custom content. Provide any content you want to test."
          }
        },
        {
          "name": "Scan EICAR via Custom Content",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"content\": \"X5O!P%@AP[4\\\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*\",\n  \"fileName\": \"eicar.com\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/malware-detection/v1/_test/clamav/scan-content",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "v1", "_test", "clamav", "scan-content"]
            },
            "description": "Scan EICAR test string via custom content endpoint"
          }
        }
      ]
    },
    {
      "name": "Test - Storage",
      "description": "Test file retrieval from storage",
      "item": [
        {
          "name": "Fetch File from Storage",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"fileStoreId\": \"your-file-store-id\",\n  \"tenantId\": \"{{tenantId}}\",\n  \"fileName\": \"test-file.pdf\",\n  \"filePath\": \"{{tenantId}}/module/December/19/test-file.pdf\",\n  \"fileSource\": \"minio\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/malware-detection/v1/_test/storage/fetch",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "v1", "_test", "storage", "fetch"]
            },
            "description": "Test fetching a file from MinIO/S3 storage. Replace fileStoreId and filePath with actual values."
          }
        }
      ]
    },
    {
      "name": "Test - Notifications",
      "description": "Test notification functionality",
      "item": [
        {
          "name": "Test Notification (Slack + Email)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"virusName\": \"Test-Virus-EICAR\",\n  \"fileStoreId\": \"test-file-123\",\n  \"tenantId\": \"{{tenantId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/malware-detection/v1/_test/notification/test",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "v1", "_test", "notification", "test"]
            },
            "description": "Send a test notification via Slack and Email. This simulates an infected file alert."
          }
        }
      ]
    },
    {
      "name": "Test - Configuration",
      "description": "View current configuration",
      "item": [
        {
          "name": "Get Configuration",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/malware-detection/v1/_test/config",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "v1", "_test", "config"]
            },
            "description": "Get current configuration (sanitized - no secrets shown)"
          }
        }
      ]
    },
    {
      "name": "Test - End-to-End",
      "description": "Full end-to-end testing",
      "item": [
        {
          "name": "E2E Scan (Fetch + Scan)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"fileStoreId\": \"your-file-store-id\",\n  \"tenantId\": \"{{tenantId}}\",\n  \"module\": \"test\",\n  \"fileName\": \"test-document.pdf\",\n  \"contentType\": \"application/pdf\",\n  \"fileSource\": \"minio\",\n  \"filePath\": \"{{tenantId}}/test/December/19/test-document.pdf\",\n  \"uploadedBy\": \"test-user-uuid\",\n  \"uploadedTime\": 1703001234567\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/malware-detection/v1/_test/e2e/scan",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "v1", "_test", "e2e", "scan"]
            },
            "description": "Full end-to-end test: Fetch file from storage and scan it with ClamAV"
          }
        }
      ]
    },
    {
      "name": "Scan API",
      "description": "Production scan endpoints",
      "item": [
        {
          "name": "Manual Scan",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"fileStoreId\": \"your-file-store-id\",\n  \"tenantId\": \"{{tenantId}}\",\n  \"module\": \"documents\",\n  \"fileName\": \"document.pdf\",\n  \"contentType\": \"application/pdf\",\n  \"fileSource\": \"minio\",\n  \"filePath\": \"{{tenantId}}/documents/December/19/document.pdf\",\n  \"uploadedBy\": \"user-uuid\",\n  \"uploadedTime\": 1703001234567\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/malware-detection/v1/scan",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "v1", "scan"]
            },
            "description": "Trigger a manual malware scan for a specific file"
          }
        },
        {
          "name": "Get Scan Result",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/malware-detection/v1/result?fileStoreId=your-file-store-id&tenantId={{tenantId}}",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "v1", "result"],
              "query": [
                {
                  "key": "fileStoreId",
                  "value": "your-file-store-id"
                },
                {
                  "key": "tenantId",
                  "value": "{{tenantId}}"
                }
              ]
            },
            "description": "Get scan result for a specific file"
          }
        },
        {
          "name": "Get Scan Results by Tenant",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/malware-detection/v1/results?tenantId={{tenantId}}&limit=100&offset=0",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "v1", "results"],
              "query": [
                {
                  "key": "tenantId",
                  "value": "{{tenantId}}"
                },
                {
                  "key": "limit",
                  "value": "100"
                },
                {
                  "key": "offset",
                  "value": "0"
                }
              ]
            },
            "description": "Get all scan results for a tenant"
          }
        },
        {
          "name": "Get Infected Files",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/malware-detection/v1/results/status/INFECTED?tenantId={{tenantId}}&limit=100",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "v1", "results", "status", "INFECTED"],
              "query": [
                {
                  "key": "tenantId",
                  "value": "{{tenantId}}"
                },
                {
                  "key": "limit",
                  "value": "100"
                }
              ]
            },
            "description": "Get all infected files"
          }
        },
        {
          "name": "Get Clean Files",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/malware-detection/v1/results/status/CLEAN?tenantId={{tenantId}}&limit=100",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "v1", "results", "status", "CLEAN"],
              "query": [
                {
                  "key": "tenantId",
                  "value": "{{tenantId}}"
                },
                {
                  "key": "limit",
                  "value": "100"
                }
              ]
            },
            "description": "Get all clean files"
          }
        },
        {
          "name": "Get Quarantined Files",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/malware-detection/v1/results/status/QUARANTINED?tenantId={{tenantId}}&limit=100",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "v1", "results", "status", "QUARANTINED"],
              "query": [
                {
                  "key": "tenantId",
                  "value": "{{tenantId}}"
                },
                {
                  "key": "limit",
                  "value": "100"
                }
              ]
            },
            "description": "Get all quarantined files"
          }
        },
        {
          "name": "Get Scan Statistics",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/malware-detection/v1/stats?tenantId={{tenantId}}",
              "host": ["{{baseUrl}}"],
              "path": ["malware-detection", "v1", "stats"],
              "query": [
                {
                  "key": "tenantId",
                  "value": "{{tenantId}}"
                }
              ]
            },
            "description": "Get scan statistics (clean, infected, quarantined counts)"
          }
        }
      ]
    }
  ]
}
